<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Intro to ChatOps with Lita</title>

		<meta name="description" content="An Upstate Ruby lightning talk">
		<meta name="author" content="Rick Yoesting">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/night.css">
		<link rel="stylesheet" href="css/overrides.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
				<h1>Intro to ChatOps with Lita</h1>
				<h2>An Upstate Ruby lightning talk</h2>
				<h4>May 25, 2016</h4>
				<p>
				<small>
					<a href="https://twitter.com/ryoe_ok">Rick Yoesting</a><br/>
					<a href="https://github.com/ryoe">ryoe on GitHub</a>
					<a href="http://twitter.com/ryoe_ok">@ryoe_ok on Twitter</a><br/>
				</small>
					</p>
				</section>
				<section>
				<h1>About me</h1>
				<h2>Places I have not worked</h2>
				<ul>
				<li>GitHub</li>
				<li>StackStorm</li>
				<li>Atlassian</li>
				<li>FlowDock</li>
				<li>PagerDuty</li>
				<li>VictorOps</li>
				</ul>
				</section>
				
				<section>
				<h1>About me</h1>
				<h2>Places I have worked</h2>
				<p>A number of companies that are not world famous. <span class="fragment">(Yet?)</span></p>
				<p class="fragment">
				Currently, <b>Clown Shoes Wrangler</b> at <a href="https://raisemore.com">RaiseMore</a>.
				</p>

				</section>

				<section>
				<h2>Why listen to me?</h2>
				<img class="fragment" src="./images/four-stars.png">

				<aside class="notes">
					I gave a lighning talk on Hubot scripts in Aug. 2014 and after all that time... 4 stars.
					I guess you could say I'm kind of an expert. ;-)
				</aside>

				</section>
				
				<section>
				<h1>ChatOps</h1>
				<h2>What is it even?</h2>
				<aside class="notes">
				Chat connects people near and far.

				At it's core, ChatOps is about communication, transparency, automation, and feedback. It's about bringing tools into the conversations you're already having in chat.
				But it's not all about work... it's also about fun!
				And building company culture.

				</aside>
				</section>
				
				<section>
				<h1>Communication</h1>
				<aside class="notes">
				"Conversation Driven Development"
				Chat is where the action is... 
				when the building is on fire!

				and when the good times roll!
				It's where the people are.

				</aside>
				</section>

				<section>
				<h1>Automation</h1>
				<ul>
				<li>Repeatable</li>
				<li>Reliable</li>
				</ul>
				<aside class="notes">
				
				Automating tricky, cumbersome or error-prone tasks is always a good idea.
				Write a script for it and run it from chat.
				This makes such a process repeatble and realiable.


				</aside>
				</section>

				<section>
				<h1>Transparency</h1>
				<aside class="notes">
				Web hooks from external sources providing info.

				Surfacing information to make informed decisions. Run a report. Show a graph. 
				Error logs. 
				Commands to retrieve info, perform tasks and report those results.

				All of this feedback happens in chat for all to see and learn from.

				In this way training is "free."

				</aside>
				</section>


				<section>
				<h1>Fun</h1>
				<aside class="notes">
				Never discount the value of fun! We're all people.

				</aside>
				</section>

				<section>
				<h1>ChatBots</h1>
				<h2>Choices</h2>
				<ul>
				<li>Hubot - CoffeeScript, JavaScript</li>
				<li>Lita - Ruby</li>
				<li>Err - Python</li>
				</ul>

				<aside class="notes">
				ChatBots for when you're ready to do more than just receive incoming web hooks.
				Choose what's best for your team in terms of development language and feature set.
				</aside>
				</section>

				<section>
				<h1>ChatBots</h1>
				<h2>What it do?</h2>
				<ul>
				<li>Hear</li>
				<li>Respond</li>
				</ul>

				<aside class="notes">
				ChatBots primarily do two things...
				Hear - "listen" for words/phrases, then take action
				Respond to commands - perform tasks of some kind when specifically instructed to do so
				</aside>
				</section>

				<section>
				<h1>Hear</h1>
				<h2>Example 1</h2>
				<img src="./images/notify-payroll.png">

				<aside class="notes">
				In this case, using feature provided by Slack. You don't have to roll your own for everything.
				</aside>
				</section>

 				<section>
				<h1>Hear</h1>
				<h2>Example 2</h2>
				<img src="./images/blood-pressure.gif">

				<aside class="notes">
				"custom" hear tailored to our culture.
				</aside>
				</section>

				<section>
				<h1>Respond</h1>
				<h2>Example 1</h2>
				<img src="./images/build-version.png">

				<aside class="notes">
				Queue a build... so easy, anyone can do it.
				</aside>
				</section>

				<section>
				<h1>Respond</h1>
				<h2>Example 2</h2>
				<img src="./images/sanity-check.png">

				<aside class="notes">
				Internal tooling...
				</aside>
				</section>

				<section>
				<h1>Respond</h1>
				<h2>Example 3</h2>
				<img src="./images/link-me-staging.png">

				<aside class="notes">
				Misc. curated links for various systems/environments.
				</aside>
				</section>

				<section>
				<h1>Respond</h1>
				<h2>Example 4</h2>
				<img src="./images/corp-bs.png">

				<aside class="notes">
				:-D
				</aside>
				</section>

				<section>
				<h1>Respond</h1>
				<h2>Example 5</h2>
				<img src="./images/rollout-prediction.gif">

				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="red">
				<h1>WARN:</h1>
				<h2>Regular Expressions</h2>
				<p>Love 'em or hate 'em, you can't avoid 'em</p>
				<p><br></p>
				<p><br></p>
				<h3 class="fragment">If you do hate 'em...</h3>

				<aside class="notes">
				All routing is handled via RegEx, so... 
				</aside>
				</section>

				<section data-background="green">
				<h1>I've got you!</h1>
				<h2><3 <3 <3</h2>

				<img src="./images/link-me-regex.png">


				<aside class="notes">
				If you need help, I got your back!
				</aside>
				</section>


				<section data-background="#337ab7" data-background-transition="zoom">
				<h1>Hello, Lita</h1>
				<img src="./images/lita_512.png">
				<p>
				<a class="white-text" href="https://www.lita.io/">Lita.io/</a>
				</p>

				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Why Lita?</h1>
				<ul>
					<li>Runs on Ruby</li>
					<li>Many chat adapters available</li>
					<li>Easy testing plugins with RSpec extras</li>
					<li>Leverage Ruby ecosystem:
					<ul>
						<li>RubyGems</li>
						<li>Bundler</li>
					</ul>
					</li>
				</ul>
				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Requirements</h1>
				<ul>
					<li>Ruby 2.x
					<ul>
						<li>or JRuby 9.0.0.0+</li>
						<li>or Rubinus 2+</li>
					</ul>
					</li>
					<li>Redis 2.6+</li>
				</ul>
				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Install Lita</h1>
				<p>&nbsp;</p>
				<h2 class="monospace">gem install lita</h2>
				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Create your bot</h1>
				<h2 class="monospace">lita new</h2>
<h2 class="monospace"><pre class="terminal">
$ lita new
      create  lita
      create  lita/Gemfile
      create  lita/lita_config.rb</pre></h2>
				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Run your bot</h1>
				<h2 class="monospace">lita start</h2>

				<img class="no-border" src="./images/lita-start.png">

				<aside class="notes">
				By default, lita is configured to use the shell adapter and does pretty much nothing else...
				help command is about the extent of things.
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Name your bot</h1>
				<h2 class="monospace">lita_config.rb</h2>
<h2 class="monospace"><pre><code>Lita.configure do |config|

  # The name your robot will use.
  config.robot.name = "Johnny Five"

end</code></pre></h2>
				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Name your bot</h1>
				<h2>Action shot</h2>

				<img class="no-border" src="./images/lita-named-bot.png">

				<aside class="notes">
				:-D
				</aside>
				</section>


				<section data-background="#337ab7">
				<h1>Plugins</h1>
				<h2>Getting more out of Lita</h2>
				<ul>
					<li>Adapters</li>
					<li>Handlers</li>
					<li>Extensions</li>
				</ul>

				<aside class="notes">
				Adapters - used to connect to a chat service.
				Handlers - add new runtime functionality
				Extensions - add new functionality to Lita's core.
				From Lita docs: Note: Extensions are an advanced topic and most of the time you won't need to write them yourself.
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Adapters</h1>
				<table>
				<tbody>
					<tr class="no-row-border">
						<td>* Slack</td>
						<td>* HipChat</td>
					</tr>
					<tr class="no-row-border">
						<td>* Flowdock</td>
						<td>* IRC</td>
					</tr>
					<tr class="no-row-border">
						<td>* Campfire</td>
						<td>* Chatwork</td>
					</tr>
					<tr class="no-row-border">
						<td>* Facebook</td>
						<td>* Gitter</td>
					</tr>
					<tr class="no-row-border">
						<td>* Telegram</td>
						<td>* idobata</td>
					</tr>
					<tr class="no-row-border">
						<td>* Telegram (another!)</td>
						<td>* Tox</td>
					</tr>
					<tr class="no-row-border">
						<td>* Twitter</td>
						<td>* VKontable</td>
					</tr>
					<tr class="no-row-border">
						<td>* Discord</td>
						<td></td>
					</tr>
				</tbody>

				</table>

				<p>
				<br/>
				<a class="white-text" href="https://plugins.lita.io/#adapters">https://plugins.lita.io/#adapters</a>
				</p>
				<aside class="notes">
				Lita adapters are used to connect to a chat service such as Slack, HipChat or IRC.
				Creating an adapter is beyond the scope of this talk, but you *can* do it if you really want to.
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Make a chat bot</h1>
				<h3>Because <b>Lita</b> is better with friends!</h3>
				<aside class="notes">
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Adapter Config</h1>
				<h3>lita_config.rb</h3>
<h2 class="monospace"><pre><code>Lita.configure do |config|
  config.robot.adapter = :slack
  config.adapters.slack.token = "my-token"
end
</code></pre>
				<h3>Gemfile</h3>
<h2 class="monospace"><pre><code>source "https://rubygems.org"

gem "lita"
gem "lita-slack"
</code></pre>

				<aside class="notes">
				This example is Slack. There are several other config options, so always consult the docs for your chosen adapter.
				Add the gem, bundle install and lita start!
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Handlers</h1>
				<h2>What it do?</h2>
				<ul>
					<li>Chat routes</li>
					<li>HTTP routes</li>
					<li>Event routes</li>
				</ul>

				<aside class="notes">
				Chat routes - your basic "hear" and "respond"
				HTTP routes - make HTTP requests to Lita's built-in web server (Faraday client, Rack::Request, Rack::Response)
				Event routes - Lita has built-in pub/sub system. Handlers can communicate and/or respond to arbitrary system events.
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Handlers</h1>
				<ul>
					<li>Install a gem<sup>*</sup></li>
					<li>Roll your own</li>
				</ul>

				<p><br><sup>*</sup><a class="white-text" href="https://plugins.lita.io/#handlers">plugins.lita.io/#handlers</a></p>
				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="#337ab7">
				<h2>Chat route "hear"</h2>

				<h3>handlers/ping.rb</h3>
<h3 class="monospace"><pre><code>module Lita
  module Handlers
    class Ping < Handler
      route(/ping/, :pong, 
        help: { "ping" => "replies back with PONG" })

      def pong response
      	response.reply "PONG"
      end

      Lita.register_handler(self)
    end
  end
end</code></pre>
</h3>

				<h3>lita_config.rb</h3>
<h3 class="monospace"><pre><code>require './handlers/ping.rb'

Lita.configure do |config|
  # my config
end
</code></pre>
</h3>
				<aside class="notes">
				:-D
				</aside>
				</section>

				<section data-background="#337ab7">
				<h2>Chat route "hear"</h2>

				<h3><span class="monospace">command</span> defaults to false</h3>
<h3 class="monospace"><pre><code>module Lita
  module Handlers
    class Ping < Handler
      route(/ping/, :pong,
        command: false, # defaults false
        help: { "ping" => "replies back with PONG" })

      def pong response
      	response.reply "PONG"
      end

      Lita.register_handler(self)
    end
  end
end</code></pre>
</h3>
				<aside class="notes">
				:-D
				</aside>
				</section>
				<section data-background="#337ab7">
				<h2>Chat route "respond"</h2>
				<h3>handlers/gnip.rb</h3>

<h3 class="monospace"><pre><code>module Lita
  module Handlers
    class Gnip < Handler
      route(/gnip/, :gnop,
        command: true, # "respond"
        help: { "gnip" => "replies back with GNOP" })

      def gnop response
        response.reply "GNOP"
      end

      Lita.register_handler(self)
    end
  end
end
</code></pre>
</h3>
				<h3>lita_config.rb</h3>
<h3 class="monospace"><pre><code>require './handlers/gnip.rb'
# the rest...
</code></pre>
</h3>
				<aside class="notes">
				command: true makes it "respond" only
				</aside>
				</section>

				<section data-background="#337ab7">
				<h2>Chat routes in action</h2>
 <h3>Hear</h3>
 <h2 class="monospace"><pre class="terminal">
Lita > I say ping
PONG
Lita > lita ping
PONG
</pre></h2>
 <h3>Respond</h3>
 <h2 class="monospace"><pre class="terminal">
Lita > I say gnip
Lita > lita gnip
GNOP
</pre></h2>
				<aside class="notes">
				"Hear" is basically the honey badger! It don't care!
				</aside>
				</section>

				<section data-background="#337ab7">
				<h1>Chat routes</h1>
				<h2><span class="monospace">response</span> helpers</h2>
				<table>
				<tbody>
				<tr>
					<td>reply</td>
					<td>send message back to source (room or user)</td>
				</tr>
				<tr>
					<td>reply_privately</td>
					<td>send message back to user</td>
				</tr>
				<tr>
					<td>matches</td>
					<td>array of Regexp matches</td>
				</tr>
				<tr>
					<td>match_data</td>
					<td>MatchData from Regexp</td>
				</tr>
				<tr>
					<td>args</td>
					<td>array of args with the "command" removed</td>
				</tr>
				<tr>
					<td>message</td>
					<td>message object</td>
				</tr>
				<tr>
					<td>user</td>
					<td>user object</td>
				</tr>
				<tr>
					<td>extensions</td>
					<td>arbitrary data from Lita extension</td>
				</tr>
				</tbody>
				</table>

				<aside class="notes">
				</aside>
				</section>

				<section data-background="#337ab7">
				<h2>Helpers example</h2>

				<h3>handlers/helpers.rb</h3>
<pre><code>module Lita
  module Handlers
    class Stars < Handler
      route(/helper[s|z] (\d*){1}/i, :puts_helper, command: true)

      def puts_helper response
        puts "matches: #{response.matches}"
        puts "match_data: #{response.match_data}"
        puts "args #{response.args}"
        puts "message: #{response.message}"
        puts "user: #{response.user}"
        puts "extensions: #{response.extensions}"

        response.reply_privately "Shh! This is private!"
        response.reply "Hola!"
      end

      Lita.register_handler(self)
    end
  end
end
</code></pre>
				<aside class="notes">
				
				</aside>
				</section>


				<section data-background="#337ab7">
				<h2>helpers.rb output</h2>
 <h3 class="monospace"><pre class="terminal">
Lita > lita helpers 42
matches: [["42"]]
match_data: helpers 42
args ["42"]
message: #<Lita::Message:0x007fbb91398da8>
user: #<Lita::User:0x007fbb91a362a0>
extensions: {}
Shh! This is private!
Hola!
</pre></h3>
				<aside class="notes">
				
				</aside>
				</section>

				<section data-background="#337ab7">
				<h2>Using <span class="monospace">args</span> helper</h2>

				<h3>handlers/stars.rb</h3>
<pre><code>module Lita
  module Handlers
    class Stars < Handler
      route(/star[s|z] (\d*){1}/i, :star_rating, command: true,
        help: { "stars &lt;num&gt;" => "replies with your star rating" })

      def star_rating response
        starz = response.args.first.to_i

        if starz > 3
          response.reply "Wow! #{starz} stars!\nYou must be an internationally recognized expert!"
        else
          response.reply "You are not your star count! We <3 you!"
        end
      end

      Lita.register_handler(self)
    end
  end
end</code></pre>
				</section>

				<section data-background="#337ab7">
				<h2>stars.rb output</h2>
 <h3 class="monospace"><pre class="terminal">
Lita > lita stars 2
You are not your star count! We <3 you!
Lita > lita stars 4
Wow! 4 stars!
You must be an internationally recognized expert!
</pre></h3>
				<aside class="notes">
				"Hear" is basically the honey badger! It don't care!
				</aside>
				</section>


				<section data-background="#337ab7">
				<h2>HTTP routes</h2>

				<aside class="notes">
				:-D
				</aside>
				</section>



				<section data-background-transition="zoom">
				<h1>Love your users!</h1>
				<h2>Always add <span class="monospace">help</span></h2>
 <h3 class="monospace"><pre class="terminal">
Lita > lita help
Lita: help - Lists help information for terms and command the robot will respond to.
Lita: help COMMAND - Lists help information for terms or commands that begin with COMMAND.
Lita: info - Replies with the current version of Lita.
Lita: users find SEARCH_TERM - Find a Lita user by ID, name, or mention name.
Lita: gnip - replies back with GNOP
ping - replies back with PONG
Lita: stars <num> - replies with your star rating</pre></h3>
				<aside class="notes">
				</aside>
				</section>

				<section data-background="green" data-background-transition="zoom">
				<h1>Resources</h1>

				<aside class="notes">
				:-D
				</aside>
				</section>

				<section>
					<h1>Thank You!</h1>
					<h1>&nbsp;</h1>
					<h3>Intro to ChatOps with Lita</h3>
					<h4>An Upstate Ruby lightning talk</h4>
				<p>&nbsp;</p>
				<p>
					<strong>Sample Scripts</strong></br>
					<strong>upstate-ruby-demo.rb and upstate-ruby-demo-greetings.rb</strong></br>
					<a href="https://github.com/ryoe/upstate-ruby-demo">https://github.com/ryoe/upstate-ruby-demo</a>
				</p>

				<p>&nbsp;</p>
				<p>
					<strong>Comments or Questions?</strong></br>
					<a href="http://twitter.com/ryoe_ok">@ryoe_ok on Twitter</a><br/>
					<a href="https://github.com/ryoe">ryoe on GitHub</a>
				</p>
				</section>

			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
